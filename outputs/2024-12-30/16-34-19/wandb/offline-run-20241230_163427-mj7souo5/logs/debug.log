2024-12-30 16:34:27,338 INFO    MainThread:2090321 [wandb_setup.py:_flush():75] Loading settings from /home/awc2159/.config/wandb/settings
2024-12-30 16:34:27,338 INFO    MainThread:2090321 [wandb_setup.py:_flush():75] Loading settings from /home/awc2159/projects/MeTra_3D/outputs/2024-12-30/16-34-19/wandb/settings
2024-12-30 16:34:27,338 INFO    MainThread:2090321 [wandb_setup.py:_flush():75] Loading settings from environment variables: {'_require_service': 'True'}
2024-12-30 16:34:27,339 WARNING MainThread:2090321 [wandb_setup.py:_flush():75] Could not find program at -m classification.training.trainer
2024-12-30 16:34:27,339 INFO    MainThread:2090321 [wandb_setup.py:_flush():75] Inferring run settings from compute environment: {'program_relpath': None, 'program': '-m classification.training.trainer'}
2024-12-30 16:34:27,339 INFO    MainThread:2090321 [wandb_setup.py:_flush():75] Applying login settings: {'mode': 'offline'}
2024-12-30 16:34:27,339 INFO    MainThread:2090321 [wandb_init.py:_log_setup():437] Logging user logs to /home/awc2159/projects/MeTra_3D/outputs/2024-12-30/16-34-19/wandb/offline-run-20241230_163427-mj7souo5/logs/debug.log
2024-12-30 16:34:27,339 INFO    MainThread:2090321 [wandb_init.py:_log_setup():438] Logging internal logs to /home/awc2159/projects/MeTra_3D/outputs/2024-12-30/16-34-19/wandb/offline-run-20241230_163427-mj7souo5/logs/debug-internal.log
2024-12-30 16:34:27,339 INFO    MainThread:2090321 [wandb_init.py:init():471] calling init triggers
2024-12-30 16:34:27,339 INFO    MainThread:2090321 [wandb_init.py:init():474] wandb.init called with sweep_config: {}
config: {}
2024-12-30 16:34:27,340 INFO    MainThread:2090321 [wandb_init.py:init():524] starting backend
2024-12-30 16:34:27,362 INFO    MainThread:2090321 [backend.py:_multiprocessing_setup():97] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-12-30 16:34:27,375 INFO    MainThread:2090321 [wandb_init.py:init():533] backend started and connected
2024-12-30 16:34:27,384 INFO    MainThread:2090321 [wandb_init.py:init():597] updated telemetry
2024-12-30 16:34:27,436 INFO    MainThread:2090321 [wandb_init.py:init():659] starting run threads in backend
2024-12-30 16:34:31,571 INFO    MainThread:2090321 [wandb_run.py:_console_start():1897] atexit reg
2024-12-30 16:34:31,573 INFO    MainThread:2090321 [wandb_run.py:_redirect():1770] redirect: SettingsConsole.WRAP
2024-12-30 16:34:31,574 INFO    MainThread:2090321 [wandb_run.py:_redirect():1807] Wrapping output streams.
2024-12-30 16:34:31,588 INFO    MainThread:2090321 [wandb_run.py:_redirect():1831] Redirects installed.
2024-12-30 16:34:31,590 INFO    MainThread:2090321 [wandb_init.py:init():684] run started, returning control to user process
2024-12-30 16:35:37,158 INFO    MainThread:2090321 [wandb_run.py:_config_callback():1131] config_cb None None {'model': None, 'cfg/dataset/name': 'MIMICLab', 'cfg/dataset/task': 'in-hospital-mortality', 'cfg/dataset/ehr_data_dir': '/data/home/awc2159/MIMIC_IV/files/mimiciv/benchmark', 'cfg/dataset/cxr_data_dir': '/data/home/awc2159/MIMIC_CXR_JPG/physionet.org/2.1.0', 'cfg/dataset/labels_set': 'None', 'cfg/dataset/data_ratio': 0.0, 'cfg/dataset/data_pairs': 'paired_ehr_cxr', 'cfg/dataset/transforms/resize': 384, 'cfg/dataset/transforms/crop': 384, 'cfg/model/name': 'MultiModalPretrainedViTLab', 'cfg/model/output_logits': 1, 'cfg/model/num_channels': 3, 'cfg/model/type': 'vit_small_patch16_384', 'cfg/model/transforms/img_size': 384, 'cfg/model/transforms/mean': [0.485, 0.456, 0.406], 'cfg/model/transforms/std': [0.229, 0.224, 0.225], 'cfg/model/meta/patch_size': 16, 'cfg/model/meta/dim': 384, 'cfg/model/meta/depth': 4, 'cfg/model/meta/heads': 4, 'cfg/model/meta/mlp_dim': 768, 'cfg/model/meta/pool': 'cls', 'cfg/model/meta/dim_head': 128, 'cfg/model/meta/dropout': 0.0, 'cfg/model/meta/emb_dropout': 0.0, 'cfg/model/meta/p_visual_dropout': 1.0, 'cfg/model/meta/p_feature_dropout': 0.0, 'cfg/scheduler/lr_scheduler': 'cosine_annealing', 'cfg/scheduler/eta_min': 1e-07, 'cfg/meta/prefix_name': 'EHR_fold_0', 'cfg/meta/output_dir': '/home/awc2159/projects/MeTra_3D/EHR_checkpoints', 'cfg/meta/evaluation_dir': '/home/awc2159/projects/MeTra_3D/EHR_evaluation_outputs', 'cfg/meta/checkpoint_path': False, 'cfg/meta/transforms': True, 'cfg/meta/precision': 32, 'cfg/meta/num_workers': 20, 'cfg/meta/batch_size': 50, 'cfg/meta/only_test': False, 'cfg/meta/deterministic': True, 'cfg/meta/cross_validation': False, 'cfg/meta/folds': [0], 'cfg/meta/imbalance_handler': 'None', 'cfg/meta/num_samples': 'None', 'cfg/meta/gpus': [0], 'cfg/meta/seed': 379647, 'cfg/optimizer/name': 'AdamW', 'cfg/optimizer/lr': 5e-06, 'cfg/optimizer/lr_scheduler': 'None', 'cfg/optimizer/scheduler_factor': 0.3, 'cfg/optimizer/gamma': 0.5, 'cfg/optimizer/patience': 15, 'cfg/early_stopping/use': False, 'cfg/early_stopping/patience': 40, 'cfg/logger/wandb/project': 'combine_image_and_text', 'cfg/logger/wandb/entity': 'infinite_imaging', 'cfg/epochs': 200, 'cfg/num_samples': 'None'}
2024-12-30 16:35:40,346 WARNING MsgRouterThr:2090321 [router.py:message_loop():76] message_loop has been closed
